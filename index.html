<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="description" content="Syzygy: Dual Code-Test C to (safe) Rust Translation using LLMs and Dynamic Analysis" />
  <meta name="keywords"
    content="Syzygy, Large Language Models, LLM, Code LLM, Code Translation, C to (safe) Rust, Dynamic Analysis, SWE" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>

  </title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []

      function gtag() {
        dataLayer.push(arguments)
      }

      gtag("js", new Date())

      gtag("config", "G-PYVRSFMDRL")
    </script> -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet" />

  <link rel="stylesheet" href="./css/bulma.min.css" />
  <link rel="stylesheet" href="./css/bulma-carousel.min.css" />
  <link rel="stylesheet" href="./css/bulma-slider.min.css" />
  <link rel="stylesheet" href="./css/fontawesome.all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <link rel="icon" href="./assets/favicon.svg" />

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./js/fontawesome.all.min.js"></script>
  <script src="./js/bulma-carousel.min.js"></script>
  <script src="./js/bulma-slider.min.js"></script>
  <script src="./js/index.js"></script>
</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <div class="logo-title-container" style="display: flex; align-items: center; justify-content: center;">
              <h1 class="title is-1 publication-title">
                <span class="dnerf">Syzygy</span>
              </h1>
            </div>
            <div>
              <h2 class="subtitle is-4 publication-subtitle">
                Dual Code-Test C to (safe) Rust Translation using LLMs and Dynamic Analysis
            </div>
            <br />

            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://manishs.org">Manish Shetty</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://naman-ntc.github.io/">Naman Jain</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://adwait.github.io/">Adwait Godbole</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://people.eecs.berkeley.edu/~sseshia/">Sanjit A. Seshia</a><sup>†</sup>,</span>
              <span class="author-block">
                <a href="https://people.eecs.berkeley.edu/~ksen/">Koushik Sen</a><sup>†</sup></span>
            </div>


            <div class="is-size-5 publication-authors">
              <span class="author-block">UC Berkeley</span>
            </div>

            <div class="is-size-6">
              <span><sup>*</sup>Equal Contribution,</span>
              <span><sup>†</sup>Equal Advising</span>
            </div>
            <br />


            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="/assets/paper.pdf" class="external-link button is-normal is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <!-- ArXiv Link. -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2412.14234" class="external-link button is-normal is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- GitHub Link. -->
                <span class="link-block">
                  <a href="https://github.com/syzygy-project/Syzygy_Zopfli" class="external-link button is-normal is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Syzygy Zopfli</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section>
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="columns is-centered">
          <img src="./assets/overview.png" alt="Teaser" class="teaser-image center" width="80%" />
        </div>
        <h4 class="hero-body has-text-justified">
          Despite extensive usage in high-performance, low-level systems programming applications,
          <span class="dnerf">C</span> is susceptible to vulnerabilities due to manual memory management and unsafe
          pointer operations.
          <span class="dnerf">Rust</span>, a modern systems programming language, offers a compelling alternative.
          Through its unique ownership model and type system, it ensures memory safety without sacrificing performance.
          We present <span class="dnerf"><b>Syzygy</b></span>, an automated approach to translate
          <span class="dnerf">C</span> to <i>safe</i> <span class="dnerf">Rust</span>.
          Our technique uses a synergistic combination of LLM-driven code and test generation guided by
          dynamic-analysis-generated execution information.
          We apply our approach to successfully translate <span class="dnerf">Zopfli</span>, a high-performance
          compression library with ~3000 lines-of-code and 98 functions.
          We validate the translation by testing equivalence with the source C program on a set of inputs. To our
          knowledge, this is the largest automated and test-validated C to <i>safe</i>
          Rust code translation achieved so far.
        </h4>

      </div>
    </div>
  </section>


  <section class="section" style="padding-top: 0;">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Dualities for <i>Safe</i> and <i>Valid</i> C to Rust</h2>
          <div class="content has-text-justified">
            As the name suggests, <span class="dnerf">Syzygy</span> exhibits two kinds of dualities that form the core
            principles of our approach.
            <ul>
              <li>
                <b>LLMs meet Dynamic Analysis.</b> First, we synergistically combine
                the superior generative capabilities of LLMs with semantic execution information collected by dynamic
                analyses on the source C codebase.
              </li>
              <li>
                <b>Dual Code-Test Translation.</b> Secondly, as opposed to using the LLM+Dynamic Analysis recipe
                to perform Rust code-generation <i>alone</i>, we also build a test translation approach
                for reliable equivalence testing.
              </li>
            </ul>
          </div>
          <br />
          <section class="video-teaser">
            <div class="container is-max-desktop">
              <div class="columns is-centered">
                <div class="column is-three-fourths">
                  <div class="video-container">
                    <!-- add overview.gif -->
                    <img src="./assets/overview.gif" alt="Syzygy Overview" class="teaser-image center" width="100%"
                      height="90%" />
                  </div>
                  <h2 class="content has-text-justified">
                    <b>Overview.</b> The <span class="dnerf">Slicer</span> decomposes
                    a codebase into translation units, <span class="dnerf">CodeGenerator</span>
                    performs translation for that unit, and <span class="dnerf">EqTester</span> checks for
                    equivalence of the generated Rust code with the original C code.
                    <span class="dnerf">ArgTranslator</span> maps the C-Rust function arguments allowing
                    appropriate equivalence checks in <span class="dnerf">EqTester</span>.
                    <span class="dnerf">SpecMiner</span>, our dynamic analysis module, mines (property and
                    I/O) specifications for internal C functions using top-level tests.
                    These specifications later assist our LLM-driven dual code-test translation.
                  </h2>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </section>


  <section class="section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered">Scaling LLM Inference with Dynamic Analysis</h2>

      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <img src="./assets/pipeline.png" alt="Pipeline" class="teaser-image" width="70%" />
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <div class="content has-text-justified">
            <p><b>Translation Pipeline.</b> As shown above, given a C function and test suite, we run four modules:
            </p>

            <ol style="list-style-type: upper-alpha;">
              <li> <span class="dnerf">SpecMiner:</span> Analyzes function execution,
                collecting I/O and key properties like types, aliasing, and bounds.</li>
              <li> <span class="dnerf">CodeGenerator:</span> An LLM uses the spec to craft a
                candidate Rust translation.</li>
              <li> <span class="dnerf">ArgTranslator:</span> An LLM creates a function that translates C I/O to Rust
                inputs and expected outputs, aligned
                with the generated Rust translation.</li>
              <li> <span class="dnerf">EqTester:</span> An LLM generates a
                test that executes the candidate translation, along with the previously generated Rust code (Invariant),
                and checks whether the outputs match expected values.</li>
            </ol>
            <br />
          </div>
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths has-text-justified">
          <p><b>Rejection Sampling.</b> As shown below, we use rejection sampling to scale LLM inference throughout the
            pipeline. To do so, we alternate between generation (→) and verification (-->) steps,
            beginning with an LLM generating N candidate Rust functions which are filtered for compilation.
            The pipeline then samples K translate_args functions for each valid candidate,
            with subsequent execution filtering and equivalence testing phases that create and verify triples,
            ultimately yielding successfully translated and equivalent Rust functions.
        </div>
      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <img src="./assets/irs.png" alt="Pipeline" class="teaser-image" width="75%" />
        </div>
      </div>

    </div>
  </section>


  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Translating Zopfli from C to Rust</h2>
          <div class="content has-text-justified">
            We <i>completely</i> translate <span class="dnerf">Zopfli</span>, a compression algorithm known
            to achieve superior compression ratios by extensively optimizing the compression process.
            The codebase consists of over 3000 lines of C code (excluding comments),
            comprising 98 functions and 10 structs, and spans over 21 files.
            It provides a challenging testbed for evaluating our approach due to the diversity of
            the source code constructs, including heap-based data structures
            (such as linked lists and array iterators), function pointers, and void* arguments.
            Our translated Zopfli program ranges over 7000 lines (including verbose comments and
            docstrings).

            <h3 class="title is-4">Pass Rate</h3>
            We study the quality of the translation candidates across functions with two metrics: compilation pass rate
            and execution pass rate. Compilation pass rate is computed as the number of translations that compile
            against the total number of translations generated. The execution pass rate is computed as the number of
            translations that pass the equivalence test compared to the total number of compiling translations.
            <div class="columns is-centered" style="padding-top:2em;">
              <img src="./assets/pass_rate.png" alt="Pass@1 on R2E-Eval1" class="teaser-image center" width="60%"
                height="60%" />
            </div>

            The mean pass rates are high, ranging over 75% for both compilable and executable translations.
            However, the distribution shows a long tail of <i>challenging</i> functions with lower pass rates (below
            20%).

            <h3 class="title is-4">Efficiency</h3>
            We further evaluated the final translated Rust code on
            varied test inputs and compared the output and execution time with the original C code.
            We construct two test suites -- first with six strings formed by repeating 'a'
            different number of times (between 10 and 1000000 times) and second with
            twelve random strings of varying lengths (between 1000 and 1000000 characters).
            Additionally, we compare the execution times under default compilation configuration
            (<code>gcc -O0 -g</code> and <code>cargo debug</code>) and optimized compilation configuration
            (<code>gcc -O3</code> and <code>cargo build --release</code>) for both the C and Rust implementations.

            <div style="padding-top:2em;">
              <table>
                <caption>Performance Comparison of C and Rust Implementations</caption>
                <thead>
                  <tr>
                    <th rowspan="2">Input Type</th>
                    <th colspan="3">Default</th>
                    <th colspan="3">Optimized</th>
                  </tr>
                  <tr>
                    <th>C</th>
                    <th>Rust</th>
                    <th>Slowdown</th>
                    <th>C</th>
                    <th>Rust</th>
                    <th>Slowdown</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Repeated Input</td>
                    <td>0.17</td>
                    <td>1.56</td>
                    <td>8.9x</td>
                    <td>0.040</td>
                    <td>0.059</td>
                    <td>1.47x</td>
                  </tr>
                  <tr>
                    <td>Random Input</td>
                    <td>0.242</td>
                    <td>3.336</td>
                    <td>13.8x</td>
                    <td>0.094</td>
                    <td>0.330</td>
                    <td>3.67x</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <br />

            We find that the translated Rust code is equivalent but slower, with larger slowdowns,
            in the default compilation compared to the optimized compilation configuration.
            Even with the compiler optimization, the Rust code is up to 3.67X slower than the C code.
          </div>
        </div>
      </div>

    </div>
  </section>


</body>

</html>
